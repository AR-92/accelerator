<div class='flex flex-col gap-4 lg:gap-6'>
    <!-- Header -->
    <div class='flex items-center justify-between'>
      <div class='grid gap-1'>
        <h1 class='font-heading text-2xl font-semibold text-foreground dark:text-white'>Landing Page Section Details</h1>
        <p class='text-base text-muted-foreground'>{{section.title}}</p>
      </div>
       <div class='flex gap-2'>
         <button onclick="previewSection({{section.id}})" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-secondary text-secondary-foreground shadow hover:bg-secondary/80 h-9 px-4 py-2'>
           {{lucide 'Eye' 'w-4 h-4 mr-2'}}
           Preview
         </button>
         <button onclick="editSection({{section.id}})" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2'>
           {{lucide 'Edit' 'w-4 h-4 mr-2'}}
           Edit Section
         </button>
         <button onclick="deleteSection({{section.id}}, '{{section.title}}')" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-destructive text-destructive-foreground shadow hover:bg-destructive/90 h-9 px-4 py-2'>
           {{lucide 'Trash2' 'w-4 h-4 mr-2'}}
           Delete Section
         </button>
       </div>
    </div>

    <!-- Section Details Card -->
    <div class='rounded-md bg-card text-card-foreground shadow-sm p-6' style='box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;'>
      <div class='grid grid-cols-1 md:grid-cols-2 gap-6'>
        <!-- Basic Information -->
        <div class='space-y-4'>
          <h2 class='text-lg font-semibold text-foreground'>Basic Information</h2>

          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Title</label>
            <p class='text-foreground font-medium'>{{section.title}}</p>
          </div>

          {{#if section.subtitle}}
          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Subtitle</label>
            <p class='text-foreground'>{{section.subtitle}}</p>
          </div>
          {{/if}}

          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Section Type</label>
            <span class='inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400'>
              {{sectionTypeLabel section.sectionType}}
            </span>
          </div>

          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Order</label>
            <p class='text-foreground'>{{section.order}}</p>
          </div>

          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Status</label>
            {{#if section.isActive}}
            <span class='inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400'>
              Active
            </span>
            {{else}}
            <span class='inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400'>
              Inactive
            </span>
            {{/if}}
          </div>
        </div>

        <!-- Content & Media -->
        <div class='space-y-4'>
          <h2 class='text-lg font-semibold text-foreground'>Content & Media</h2>

          {{#if section.imageUrl}}
          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Image</label>
            <img src='{{section.imageUrl}}' alt='{{section.title}}' class='w-full h-32 object-cover rounded-md border border-border'>
          </div>
          {{/if}}

          {{#if section.content}}
          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Content</label>
            <div class='bg-muted/50 rounded-md p-4'>
              <p class='text-foreground whitespace-pre-wrap'>{{section.content}}</p>
            </div>
          </div>
          {{/if}}

          {{#if section.buttonText}}
          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Button</label>
            <div class='flex items-center gap-2'>
              <span class='text-foreground font-medium'>{{section.buttonText}}</span>
              {{#if section.buttonUrl}}
              <span class='text-muted-foreground'>â†’</span>
              <a href='{{section.buttonUrl}}' target='_blank' class='text-primary hover:underline text-sm'>{{section.buttonUrl}}</a>
              {{/if}}
            </div>
          </div>
          {{/if}}
        </div>
      </div>

      <!-- Metadata -->
      <div class='mt-6 pt-6 border-t border-border'>
        <h2 class='text-lg font-semibold text-foreground mb-4'>Metadata</h2>
        <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Section ID</label>
            <p class='text-foreground font-mono text-sm'>{{section.id}}</p>
          </div>

          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Created At</label>
            <p class='text-foreground'>{{formatDate section.createdAt}}</p>
          </div>

          <div>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Updated At</label>
            <p class='text-foreground'>{{formatDate section.updatedAt}}</p>
          </div>

          {{#if section.metadata}}
          <div class='md:col-span-2'>
            <label class='block text-sm font-medium text-muted-foreground mb-1'>Additional Metadata</label>
            <pre class='bg-muted/50 rounded-md p-4 text-sm overflow-x-auto'><code>{{json section.metadata}}</code></pre>
          </div>
          {{/if}}
        </div>
      </div>
    </div>

    <!-- Back Button -->
    <div class='flex justify-start'>
      <a href='/admin/landing-page' class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2'>
        {{lucide 'ArrowLeft' 'w-4 h-4 mr-2'}}
        Back to Landing Page
      </a>
    </div>
  </div>

  <!-- Edit Section Modal -->
  <div id="editSectionModal" class="fixed inset-0 bg-background/80 backdrop-blur-sm overflow-y-auto h-full w-full hidden">
    <div class="relative top-20 mx-auto p-5 border border-border w-96 shadow-lg rounded-md bg-card">
      <div class="mt-3">
        <h3 class="text-lg font-medium text-foreground mb-4">Edit Landing Page Section</h3>
        <form id="editSectionForm">
          <input type="hidden" id="editSectionId" value="{{section.id}}">
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Section Type</label>
            <select id="editSectionType" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring" required>
              {{#each sectionTypes}}
              <option value="{{value}}" {{#if (eq ../section.sectionType value)}}selected{{/if}}>{{label}}</option>
              {{/each}}
            </select>
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Title</label>
            <input type="text" id="editSectionTitle" value="{{section.title}}" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring" required>
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Subtitle</label>
            <input type="text" id="editSectionSubtitle" value="{{section.subtitle}}" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Content</label>
            <textarea id="editSectionContent" rows="4" class="flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">{{section.content}}</textarea>
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Image URL</label>
            <input type="url" id="editSectionImageUrl" value="{{section.imageUrl}}" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Button Text</label>
            <input type="text" id="editSectionButtonText" value="{{section.buttonText}}" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Button URL</label>
            <input type="url" id="editSectionButtonUrl" value="{{section.buttonUrl}}" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-foreground mb-2">Order</label>
            <input type="number" id="editSectionOrder" min="0" value="{{section.order}}" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
          </div>
          <div class="mb-4">
            <label class="flex items-center">
              <input type="checkbox" id="editSectionIsActive" {{#if section.isActive}}checked{{/if}} class="rounded border-gray-300 text-primary focus:ring-primary mr-2">
              <span class="text-sm font-medium text-foreground">Active</span>
            </label>
          </div>
          <div class="flex justify-end gap-2">
            <button type="button" onclick="closeEditModal()" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2">Cancel</button>
            <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
  // Helper functions for date formatting
  function formatDate(dateString) {
    return new Date(dateString).toLocaleDateString();
  }

  // Modal functions
  function editSection(sectionId) {
    document.getElementById('editSectionModal').classList.remove('hidden');
  }

  function closeEditModal() {
    document.getElementById('editSectionModal').classList.add('hidden');
  }

  function deleteSection(sectionId, sectionTitle) {
    Toast.warning(`Are you sure you want to delete the section "${sectionTitle}"? This action cannot be undone.`);
    fetch(`/admin/api/landing-page/${sectionId}`, {
      method: 'DELETE',
      headers: {
        'Content-Type': 'application/json',
      },
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        window.location.href = '/admin/landing-page';
      } else {
        Toast.error('Error deleting section: ' + data.error);
      }
    });
  }

  // Form handlers
  document.getElementById('editSectionForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const sectionId = document.getElementById('editSectionId').value;
    const sectionData = {
      sectionType: document.getElementById('editSectionType').value,
      title: document.getElementById('editSectionTitle').value,
      subtitle: document.getElementById('editSectionSubtitle').value,
      content: document.getElementById('editSectionContent').value,
      imageUrl: document.getElementById('editSectionImageUrl').value,
      buttonText: document.getElementById('editSectionButtonText').value,
      buttonUrl: document.getElementById('editSectionButtonUrl').value,
      order: parseInt(document.getElementById('editSectionOrder').value) || 0,
      isActive: document.getElementById('editSectionIsActive').checked,
    };

    fetch(`/admin/api/landing-page/${sectionId}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(sectionData),
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        location.reload();
      } else {
        Toast.error('Error updating section: ' + data.error);
      }
    });
    });

    // Preview section
    window.previewSection = function(sectionId) {
      // Simple preview - in a real implementation, this would render the section
      // For now, just show the section data in a modal
      fetch(`/admin/api/landing-page/${sectionId}`)
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            const section = data.section;
            const previewModal = document.getElementById('previewModal');
            const previewContent = document.getElementById('previewContent');

            let content = `
              <div class="space-y-4">
                <h3 class="text-lg font-semibold">${section.title}</h3>
                ${section.subtitle ? `<p class="text-muted-foreground">${section.subtitle}</p>` : ''}
                ${section.content ? `<div class="prose">${section.content.replace(/\n/g, '<br>')}</div>` : ''}
                ${section.buttonText && section.buttonUrl ? `<a href="${section.buttonUrl}" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2">${section.buttonText}</a>` : ''}
              </div>
            `;

            previewContent.innerHTML = content;
            previewModal.classList.remove('hidden');
          } else {
            Toast.error('Error loading section: ' + data.error);
          }
        });
    };

    // Close preview modal
    document.getElementById('closePreviewModal').addEventListener('click', function() {
      document.getElementById('previewModal').classList.add('hidden');
    });
  </script>

  <!-- Preview Modal -->
  <div id="previewModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-card rounded-lg shadow-lg max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-semibold text-foreground">Section Preview</h2>
          <button id="closePreviewModal" class="text-muted-foreground hover:text-foreground">
            {{lucide 'X' 'w-6 h-6'}}
          </button>
        </div>
        <div id="previewContent" class="text-foreground">
          <!-- Preview content will be inserted here -->
        </div>
      </div>
    </div>
  </div>