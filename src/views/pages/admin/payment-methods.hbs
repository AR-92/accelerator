<div class='flex flex-col gap-4 lg:gap-6'>
   <!-- Header -->
   <div class='flex items-center justify-between'>
     <div class='grid gap-1'>
       <h1 class='font-heading text-2xl font-semibold text-foreground dark:text-white'>Payment Methods</h1>
       <p class='text-base text-muted-foreground'>Manage payment methods and configurations</p>
     </div>
     <div class='flex gap-2'>
        <button onclick="addPaymentMethod()" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2'>
          {{lucide 'Plus' 'w-4 h-4 mr-2'}}
          Add Method
        </button>
     </div>
   </div>

  <!-- Stats Cards -->
  <div class='grid gap-4 md:grid-cols-2 lg:grid-cols-4'>
    <div class='rounded-lg border bg-card text-card-foreground shadow-sm p-6'>
      <div class='flex flex-row items-center justify-between space-y-0 pb-2'>
        <h3 class='tracking-tight text-sm font-medium'>Total Methods</h3>
        {{lucide 'CreditCard' 'h-4 w-4 text-muted-foreground'}}
      </div>
      <div class='text-2xl font-bold'>{{stats.totalMethods}}</div>
    </div>
    <div class='rounded-lg border bg-card text-card-foreground shadow-sm p-6'>
      <div class='flex flex-row items-center justify-between space-y-0 pb-2'>
        <h3 class='tracking-tight text-sm font-medium'>Active</h3>
        {{lucide 'CheckCircle' 'h-4 w-4 text-muted-foreground'}}
      </div>
      <div class='text-2xl font-bold'>{{stats.activeCount}}</div>
    </div>
    <div class='rounded-lg border bg-card text-card-foreground shadow-sm p-6'>
      <div class='flex flex-row items-center justify-between space-y-0 pb-2'>
        <h3 class='tracking-tight text-sm font-medium'>Stripe</h3>
        {{lucide 'CreditCard' 'h-4 w-4 text-muted-foreground'}}
      </div>
      <div class='text-2xl font-bold'>{{stats.stripeCount}}</div>
    </div>
    <div class='rounded-lg border bg-card text-card-foreground shadow-sm p-6'>
      <div class='flex flex-row items-center justify-between space-y-0 pb-2'>
        <h3 class='tracking-tight text-sm font-medium'>PayPal</h3>
        {{lucide 'DollarSign' 'h-4 w-4 text-muted-foreground'}}
      </div>
      <div class='text-2xl font-bold'>{{stats.paypalCount}}</div>
    </div>
  </div>

   <!-- Payment Methods Table -->
    <div class='rounded-md bg-card text-card-foreground shadow-sm overflow-visible' style='box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;'>
     <div class='px-6 py-4 border-b border-border'>
       <h2 class='text-lg font-medium text-foreground'>Payment Methods</h2>
     </div>
     <div class='overflow-x-auto'>
       <table class='w-full'>
         <thead>
           <tr class='border-b border-border'>
             <th class='h-12 px-4 text-left align-middle font-medium text-muted-foreground'>Method</th>
             <th class='h-12 px-4 text-left align-middle font-medium text-muted-foreground'>Provider</th>
             <th class='h-12 px-4 text-left align-middle font-medium text-muted-foreground'>Status</th>
             <th class='h-12 px-4 text-left align-middle font-medium text-muted-foreground'>Configuration</th>
             <th class='h-12 px-4 text-left align-middle font-medium text-muted-foreground'>Created</th>
             <th class='h-12 px-4 text-left align-middle font-medium text-muted-foreground'>Actions</th>
           </tr>
         </thead>
         <tbody>
           {{#each paymentMethods}}
           <tr class='border-b border-border hover:bg-muted/50'>
             <td class='p-4 align-middle'>
               <div class='flex items-center gap-3'>
                 {{#if (eq provider 'stripe')}}
                   {{lucide 'CreditCard' 'h-5 w-5 text-blue-500'}}
                 {{else if (eq provider 'paypal')}}
                   {{lucide 'DollarSign' 'h-5 w-5 text-blue-600'}}
                 {{else}}
                   {{lucide 'Wallet' 'h-5 w-5 text-gray-500'}}
                 {{/if}}
                 <div>
                   <div class='font-medium text-foreground'>{{method_name}}</div>
                   <div class='text-sm text-muted-foreground'>ID: {{id}}</div>
                 </div>
               </div>
             </td>
             <td class='p-4 align-middle'>
               <span class='inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium
                 {{#if (eq provider 'stripe')}}bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300
                 {{else if (eq provider 'paypal')}}bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300
                 {{else}}bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300{{/if}}'>
                 {{capitalize provider}}
               </span>
             </td>
             <td class='p-4 align-middle'>
               <span class='inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium
                 {{#if is_active}}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300
                 {{else}}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300{{/if}}'>
                 {{#if is_active}}Active{{else}}Inactive{{/if}}
               </span>
             </td>
             <td class='p-4 align-middle'>
               <div class='text-sm'>
                 {{#if api_key}}
                 <div class='text-muted-foreground'>API Key: ****{{api_key.slice -4}}</div>
                 {{/if}}
                 {{#if webhook_secret}}
                 <div class='text-muted-foreground'>Webhook: ****{{webhook_secret.slice -4}}</div>
                 {{/if}}
                 {{#if (eq provider 'stripe')}}
                 <div class='text-muted-foreground'>Publishable: ****{{publishable_key.slice -4}}</div>
                 {{/if}}
               </div>
             </td>
             <td class='p-4 align-middle'>
               <span class='text-sm text-muted-foreground'>{{formatDate created_at}}</span>
             </td>
             <td class='p-4 align-middle'>
               <div class='flex items-center gap-2'>
                 <button onclick="editPaymentMethod({{id}})" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 w-8'>
                   {{lucide 'Edit' 'h-4 w-4'}}
                 </button>
                 <button onclick="toggleStatus({{id}}, {{is_active}})" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 w-8'>
                   {{#if is_active}}
                     {{lucide 'Pause' 'h-4 w-4'}}
                   {{else}}
                     {{lucide 'Play' 'h-4 w-4'}}
                   {{/if}}
                 </button>
                 <button onclick="deletePaymentMethod({{id}})" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-8 w-8 text-destructive hover:bg-destructive hover:text-destructive-foreground'>
                   {{lucide 'Trash2' 'h-4 w-4'}}
                 </button>
               </div>
             </td>
           </tr>
           {{/each}}
         </tbody>
       </table>
     </div>
   </div>
</div>

<script>
// Payment method actions
function addPaymentMethod() {
  // TODO: Implement add payment method modal
  alert('Add payment method functionality coming soon!');
}

function editPaymentMethod(id) {
  // TODO: Implement edit payment method
  alert('Edit payment method functionality coming soon!');
}

function toggleStatus(id, currentStatus) {
  const action = currentStatus ? 'deactivate' : 'activate';
  if (confirm(`Are you sure you want to ${action} this payment method?`)) {
    // TODO: Implement toggle status
    alert(`Toggle status functionality coming soon!`);
  }
}

function deletePaymentMethod(id) {
  if (confirm('Are you sure you want to delete this payment method? This action cannot be undone.')) {
    // TODO: Implement delete payment method
    alert('Delete payment method functionality coming soon!');
  }
}

// Helper functions for Handlebars
function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

function formatDate(dateStr) {
  return new Date(dateStr).toLocaleDateString();
}
</script>