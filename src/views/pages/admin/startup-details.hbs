<div class='flex flex-col gap-4 lg:gap-6'>
  <!-- Header -->
  <div class='flex items-center justify-between'>
    <div class='grid gap-1'>
      <h1 class='font-heading text-2xl font-semibold text-foreground dark:text-white'>Startup Details</h1>
      <p class='text-base text-muted-foreground'>{{startup.name}} ({{startup.industry}})</p>
    </div>
    <div class='flex gap-2'>
      <button onclick="window.history.back()" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2'>
        ‚Üê Back to Startups
      </button>
    </div>
  </div>

  <!-- Startup Info Cards -->
  <div class='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4'>
    <!-- Basic Information -->
    <div class='rounded-md bg-card text-card-foreground shadow-sm p-6' style='box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;'>
      <h3 class='text-lg font-medium text-foreground mb-4'>Basic Information</h3>
      <div class='space-y-3'>
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Name</label>
          <p class='text-sm text-foreground'>{{startup.name}}</p>
        </div>
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Industry</label>
          <p class='text-sm text-foreground'>{{startup.industry}}</p>
        </div>
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Status</label>
          <span class='inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {{#if (eq startup.status 'active')}}bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400{{else if (eq startup.status 'inactive')}}bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400{{else if (eq startup.status 'acquired')}}bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400{{else}}bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400{{/if}}'>
            {{startup.status}}
          </span>
        </div>
        {{#if startup.website}}
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Website</label>
          <a href="{{startup.website}}" target="_blank" class='text-sm text-blue-600 hover:text-blue-800'>{{startup.website}}</a>
        </div>
        {{/if}}
      </div>
    </div>

    <!-- Details -->
    <div class='rounded-md bg-card text-card-foreground shadow-sm p-6' style='box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;'>
      <h3 class='text-lg font-medium text-foreground mb-4'>Details</h3>
      <div class='space-y-3'>
        {{#if startup.description}}
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Description</label>
          <p class='text-sm text-foreground'>{{startup.description}}</p>
        </div>
        {{/if}}
        {{#if startup.foundedDate}}
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Founded Date</label>
          <p class='text-sm text-foreground' id="foundedDate">{{startup.foundedDate}}</p>
        </div>
        {{/if}}
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>User ID</label>
          <p class='text-sm text-foreground'>{{startup.userId}}</p>
        </div>
      </div>
    </div>

    <!-- Timestamps -->
    <div class='rounded-md bg-card text-card-foreground shadow-sm p-6' style='box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;'>
      <h3 class='text-lg font-medium text-foreground mb-4'>Timestamps</h3>
      <div class='space-y-3'>
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Created</label>
          <p class='text-sm text-foreground' id="createdAt">{{startup.createdAt}}</p>
        </div>
        <div>
          <label class='block text-sm font-medium text-muted-foreground'>Last Updated</label>
          <p class='text-sm text-foreground' id="updatedAt">{{startup.updatedAt}}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class='rounded-md bg-card text-card-foreground shadow-sm p-6' style='box-shadow: rgba(0, 0, 0, 0.15) 0px 1px 2px 0px;'>
    <h3 class='text-lg font-medium text-foreground mb-4'>Quick Actions</h3>
    <div class='flex flex-wrap gap-2'>
      <button onclick="editStartup({{startup.id}})" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2'>
        Edit Startup
      </button>
      <button onclick="deleteStartup({{startup.id}}, '{{startup.name}}')" class='inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-destructive text-destructive-foreground shadow hover:bg-destructive/90 h-9 px-4 py-2'>
        Delete Startup
      </button>
    </div>
  </div>
</div>

<!-- Edit Startup Modal -->
<div id="editStartupModal" class="fixed inset-0 bg-background/80 backdrop-blur-sm overflow-y-auto h-full w-full hidden">
  <div class="relative top-20 mx-auto p-5 border border-border w-96 shadow-lg rounded-md bg-card">
    <div class="mt-3">
      <h3 class="text-lg font-medium text-foreground mb-4">Edit Startup</h3>
      <form id="editStartupForm">
        <input type="hidden" id="editStartupId">
        <div class="mb-4">
          <label class="block text-sm font-medium text-foreground mb-2">Name</label>
          <input type="text" id="editStartupName" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring" required>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-foreground mb-2">Industry</label>
          <input type="text" id="editStartupIndustry" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring" required>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-foreground mb-2">Status</label>
          <select id="editStartupStatus" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
            <option value="acquired">Acquired</option>
            <option value="failed">Failed</option>
          </select>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-foreground mb-2">Description</label>
          <textarea id="editStartupDescription" rows="3" class="flex min-h-[80px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"></textarea>
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-foreground mb-2">Website</label>
          <input type="url" id="editStartupWebsite" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-foreground mb-2">Founded Date</label>
          <input type="date" id="editStartupFoundedDate" class="flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring">
        </div>
        <div class="flex justify-end gap-2">
          <button type="button" onclick="closeEditStartupModal()" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2">Cancel</button>
          <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Helper functions for date formatting
function formatDate(dateString) {
  if (!dateString) return '';
  return new Date(dateString).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}

// Format dates on page load
document.addEventListener('DOMContentLoaded', function() {
  const createdAtEl = document.getElementById('createdAt');
  const updatedAtEl = document.getElementById('updatedAt');
  const foundedDateEl = document.getElementById('foundedDate');

  if (createdAtEl && createdAtEl.textContent) {
    createdAtEl.textContent = formatDate(createdAtEl.textContent.trim());
  }
  if (updatedAtEl && updatedAtEl.textContent) {
    updatedAtEl.textContent = formatDate(updatedAtEl.textContent.trim());
  }
  if (foundedDateEl && foundedDateEl.textContent) {
    foundedDateEl.textContent = formatDate(foundedDateEl.textContent.trim());
  }
});

// Modal functions
function editStartup(startupId) {
  // Fetch startup data and populate modal
  fetch(`/admin/api/startups/${startupId}`)
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        document.getElementById('editStartupId').value = data.startup.id;
        document.getElementById('editStartupName').value = data.startup.name;
        document.getElementById('editStartupIndustry').value = data.startup.industry;
        document.getElementById('editStartupStatus').value = data.startup.status;
        document.getElementById('editStartupDescription').value = data.startup.description || '';
        document.getElementById('editStartupWebsite').value = data.startup.website || '';
        document.getElementById('editStartupFoundedDate').value = data.startup.foundedDate || '';
        document.getElementById('editStartupModal').classList.remove('hidden');
      }
    });
}

function closeEditStartupModal() {
  document.getElementById('editStartupModal').classList.add('hidden');
}

function deleteStartup(startupId, startupName) {
  Toast.warning(`Are you sure you want to delete startup "${startupName}"? This action cannot be undone.`);
  fetch(`/admin/api/startups/${startupId}`, {
    method: 'DELETE',
    headers: {
      'Content-Type': 'application/json',
    },
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      window.location.href = '/admin/startups';
    } else {
      Toast.error('Error deleting startup: ' + data.error);
    }
  });
}

// Form handler
document.getElementById('editStartupForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const startupId = document.getElementById('editStartupId').value;
  const name = document.getElementById('editStartupName').value;
  const industry = document.getElementById('editStartupIndustry').value;
  const status = document.getElementById('editStartupStatus').value;
  const description = document.getElementById('editStartupDescription').value;
  const website = document.getElementById('editStartupWebsite').value;
  const foundedDate = document.getElementById('editStartupFoundedDate').value;

  fetch(`/admin/api/startups/${startupId}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      name,
      industry,
      status,
      description,
      website,
      foundedDate
    }),
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      closeEditStartupModal();
      location.reload();
    } else {
      Toast.error('Error updating startup: ' + data.error);
    }
  });
});
</script>